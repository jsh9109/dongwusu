<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŠ¨ç‰©å¡‘äººæ ¼æµ‹è¯„ - å‘ç°ä½ çš„å†…åœ¨åŠ¨ç‰©åŸå‹</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ================= æ£®ç³»è§†è§‰ç³»ç»Ÿ (ä¿æŒä¸å˜) ================= */
        :root {
            --primary: #2D6A4F;       /* æ£®æ—æ·±ç»¿ */
            --primary-light: #52B788; /* å«©èŠ½ç»¿ */
            --bg-body: #F1F8E9;       /* ææµ…ç»¿èƒŒæ™¯ */
            --bg-card: #FFFFFF;       /* å¡ç‰‡ç™½ */
            --text-main: #1B4332;     /* æ·±å¢¨ç»¿æ–‡å­— */
            --red-price: #D35400;     /* ä»·æ ¼çº¢ */
            --border-gold: #D4AF37;   /* é‡‘è‰² */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(180deg, #F1F8E9 0%, #E0F2F1 100%);
            min-height: 100vh;
            padding: 15px;
            color: var(--text-main);
            line-height: 1.6;
        }

        .container { max-width: 650px; margin: 0 auto; padding-bottom: 60px; }
        .hidden { display: none !important; }

        .card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(45, 106, 79, 0.08);
            margin-bottom: 20px;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* é¦–é¡µæ ·å¼ */
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { 
            background: linear-gradient(135deg, #2D6A4F 0%, #1B4332 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            font-size: 28px; font-weight: 800; margin-bottom: 8px;
        }
        .header-tag { background: var(--primary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; display: inline-block; }

        /* åŠ¨ç‰©å±•ç¤ºæ ¼ */
        .animal-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 25px 0; }
        .animal-item { background: #fff; border: 1px solid #C6EBC5; border-radius: 12px; text-align: center; padding: 10px 5px; opacity: 0.8; }
        .animal-item.active { border: 2px solid var(--primary); background: #E8F5E9; opacity: 1; transform: scale(1.05); box-shadow: 0 4px 10px rgba(45,106,79,0.2); }
        .ani-icon { font-size: 24px; display: block; margin-bottom: 5px; }
        .ani-name { font-size: 11px; color: var(--primary); font-weight: bold; }

        .feature-box { background: #FFFDE7; border: 2px dashed var(--border-gold); padding: 20px; border-radius: 15px; margin: 25px 0; }
        .feature-list li { list-style: none; margin-bottom: 8px; font-size: 14px; display: flex; align-items: center; color: #555; }
        .feature-list li::before { content: "ğŸƒ"; margin-right: 8px; }
        
        .input-group input { width: 100%; padding: 15px; border: 2px solid #A7D7C5; border-radius: 12px; text-align: center; font-size: 16px; margin-bottom: 15px; }
        .btn-start { 
            width: 100%; padding: 16px; background: linear-gradient(135deg, #2D6A4F 0%, #1B4332 100%);
            color: white; border: none; border-radius: 50px; font-size: 18px; font-weight: bold;
            box-shadow: 0 8px 20px rgba(45, 106, 79, 0.3); cursor: pointer; 
        }

        /* ç­”é¢˜é¡µ */
        .progress-bar { height: 8px; background: #E0E0E0; border-radius: 4px; margin-bottom: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
        .question-text { font-size: 18px; font-weight: bold; color: var(--text-main); margin-bottom: 25px; line-height: 1.5; }
        .option { 
            padding: 16px; background: #fff; border: 2px solid #E8F5E9; border-radius: 12px;
            margin-bottom: 10px; cursor: pointer; transition: all 0.2s; font-size: 15px; color: #444;
        }
        .option.selected { border-color: var(--primary); background: #E8F5E9; color: var(--primary); font-weight: bold; }
        .nav-buttons { display: flex; gap: 15px; margin-top: 30px; }
        .nav-btn { flex: 1; padding: 14px; border-radius: 10px; border: none; font-size: 15px; cursor: pointer; font-weight: bold; }
        .btn-prev { background: #f1f1f1; color: #666; }
        .btn-next { background: var(--primary); color: white; }

        /* ç»“æœé¡µ - ç´§å‡‘å¤´éƒ¨ */
        .result-header { 
            text-align: center; background: linear-gradient(135deg, #2D6A4F 0%, #1B4332 100%); 
            color: white; padding: 15px; border-radius: 20px 20px 0 0; margin: -25px -25px 15px -25px; position: relative;
        }
        .animal-badge { font-size: 40px; margin: 5px 0; display: inline-block; filter: drop-shadow(0 2px 5px rgba(0,0,0,0.2)); }
        .res-title { font-size: 20px; font-weight: bold; margin: 0; line-height: 1.2; }
        .res-tag { font-size: 12px; background: rgba(255,255,255,0.2); padding: 2px 10px; border-radius: 10px; display: inline-block; margin-top: 5px; }

        /* å…è´¹å†…å®¹åŒº */
        .light-side { margin-bottom: 25px; }
        .free-card { 
            background: #fff; padding: 20px; border-radius: 10px; margin-top: 15px; 
            border: 1px solid #E8F5E9; box-shadow: 0 4px 15px rgba(0,0,0,0.03);
        }
        .free-title { color: var(--primary); font-weight: bold; font-size: 16px; margin-bottom: 12px; border-left: 4px solid var(--primary); padding-left: 10px; display: flex; align-items: center; }
        .free-text p { margin-bottom: 12px; font-size: 14px; color: #444; line-height: 1.8; text-align: justify; }
        .free-text strong { color: #2D6A4F; font-weight: bold; }
        .free-highlight { background: #F1F8E9; padding: 10px; border-radius: 6px; font-size: 13px; color: #388E3C; margin-top: 10px; border: 1px dashed #A5D6A7; }

        .tags-cloud { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
        .tag-pill { background: #E8F5E9; color: #2D6A4F; font-size: 12px; padding: 4px 10px; border-radius: 4px; font-weight: bold; }

        .score-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .score-item-mini { background: #fff; border: 1px solid #C6EBC5; padding: 8px; border-radius: 8px; text-align: center; }
        .si-name { font-size: 12px; color: #666; display: block; }
        .si-val { font-size: 15px; font-weight: bold; color: var(--primary); }

        /* æ¨¡ç³ŠåŒºä¸æ”¯ä»˜ */
        .blur-container { position: relative; background: #fff; border: 1px solid #eee; border-radius: 12px; padding: 20px; overflow: hidden; margin: 25px 0; }
        .blur-content { filter: blur(5px); opacity: 0.7; user-select: none; }
        .lock-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.95) 60%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .unlock-btn { background: linear-gradient(90deg, #D4AF37 0%, #C5A028 100%); color: white; border: none; padding: 12px 30px; border-radius: 50px; font-size: 16px; font-weight: bold; box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4); cursor: pointer; animation: pulse 2s infinite; }
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }

        /* æ”¯ä»˜é¢æ¿ */
        .pay-panel { background: #fff; border-radius: 16px; padding: 25px 20px; text-align: center; border: 1px solid #eee; margin-top: 25px; }
        .price-main { font-size: 36px; color: #D35400; font-weight: 800; line-height: 1; }
        
        .quick-btn { width: 100%; padding: 12px; border-radius: 8px; border: none; color: white; font-weight: bold; font-size: 15px; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-ali { background: #1677FF; }
        .btn-wx { background: #07C160; }
        
        .qr-row { display: flex; justify-content: center; gap: 15px; margin: 20px 0; }
        .qr-wrap { width: 120px; text-align: center; }
        .qr-label { font-size: 12px; color: white; padding: 4px; border-radius: 4px 4px 0 0; }
        .qr-img { width: 100%; border: 1px solid #eee; border-top: none; border-radius: 0 0 6px 6px; }

        .copy-row { display: flex; justify-content: space-between; align-items: center; background: #f8f9fa; padding: 10px 15px; border-radius: 8px; margin-bottom: 10px; font-size: 13px; }
        .copy-btn-sm { padding: 4px 10px; background: #2D6A4F; border: none; border-radius: 4px; cursor: pointer; color: white; }
        .upload-btn { background: linear-gradient(135deg, #D35400 0%, #E65100 100%); color: white; padding: 15px; border-radius: 10px; font-weight: bold; width: 100%; display: flex; align-items: center; justify-content: center; margin-top: 20px; cursor: pointer; }
        .after-pay-guide { margin-top: 15px; background: #fff3e0; border: 1px dashed #ffb74d; border-radius: 8px; padding: 12px; text-align: left; font-size: 13px; color: #e65100; }

        /* --- æ–°å¢ï¼šæ·±åº¦æŠ¥å‘Šä¸“å±æ ·å¼ (å¯¹åº”å›¾ç‰‡æ¿å—) --- */
        .report-section-new { 
            margin-bottom: 25px; 
            padding-bottom: 20px; 
            border-bottom: 1px dashed #E0E0E0; 
        }
        .report-section-new:last-child { border-bottom: none; }
        
        .rs-title { 
            font-size: 16px; font-weight: bold; color: #2D6A4F; 
            display: flex; align-items: center; margin-bottom: 12px; 
        }
        .rs-icon { margin-right: 8px; font-size: 18px; }
        .rs-content { font-size: 14px; color: #555; line-height: 1.8; text-align: justify; }

        .highlight-box { 
            background: #F4F8FB; border-radius: 6px; padding: 12px; 
            font-size: 13px; color: #444; margin-top: 10px; 
            border-left: 3px solid #66A6FF; 
        }
        .warn-box { 
            background: #FFF5F5; border-radius: 6px; padding: 12px; 
            font-size: 13px; color: #C0392B; margin-top: 10px; 
            border-left: 3px solid #E74C3C; 
        }
        
        /* æ‹›å‹Ÿå­¦å¾’ */
        .recruit-card { background: #E8F5E9; border: 1px dashed #2D6A4F; border-radius: 12px; padding: 15px; text-align: center; margin-top: 30px; }
        .recruit-copy-box { display: flex; align-items: center; justify-content: center; gap: 10px; background: white; padding: 8px 15px; border-radius: 20px; width: fit-content; margin: 10px auto 0 auto; border: 1px solid #C6EBC5; }

        /* å…¨å›¾é‰´ */
        .gallery-box { margin-top: 25px; padding-top: 20px; border-top: 1px dashed #eee; }
        .gallery-title { font-size: 14px; color: #666; text-align: center; margin-bottom: 15px; font-weight: bold; }
        
        /* ç®¡ç†å‘˜é¢æ¿ */
        .admin-box { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; margin-top: 15px; }
        .admin-btn { padding: 8px 15px; background: #2D6A4F; color: white; border: none; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        .admin-btn:hover { background: #1B4332; transform: scale(1.02); }
        .log-list { margin-top:10px; max-height:120px; overflow-y:auto; border-top:1px dashed #ccc; padding-top:10px; }
        .log-item { font-size:12px; color:#555; margin-bottom:5px; display:flex; justify-content:space-between; }
    </style>
</head>
<body>

<div class="container">

    <div id="verifyPage" class="card">
        <div class="header">
            <span class="header-tag">å¿ƒç†å­¦ X åŠ¨ç‰©è¡Œä¸ºå­¦</span>
            <h1 style="margin-top:10px;">ğŸŒ³ åŠ¨ç‰©å¡‘äººæ ¼æµ‹è¯„</h1>
            <p>æ½œæ„è¯†é‡Œçš„ä½ æ˜¯å“ªç§åŠ¨ç‰©ï¼Ÿæµ‹å®Œç§’æ‡‚è‡ªå·±</p>
        </div>

        <div class="animal-grid">
            <div class="animal-item"><span class="ani-icon">ğŸ¦</span><span class="ani-name">é¢†è¢–ç‹®</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¦‰</span><span class="ani-name">æ™ºè€…é¸®</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¬</span><span class="ani-name">åè°ƒè±š</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¦…</span><span class="ani-name">è¿œè§é¹°</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¦Š</span><span class="ani-name">æœºæ™ºç‹</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¦Œ</span><span class="ani-name">éšå£«é¹¿</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ±</span><span class="ani-name">è‡ªç”±çŒ«</span></div>
            <div class="animal-item"><span class="ani-icon">ğŸ¶</span><span class="ani-name">å®ˆæŠ¤çŠ¬</span></div>
        </div>

        <div class="feature-box">
            <h3 style="color:#D35400; font-size:16px; margin-bottom:12px;">ğŸ“Š æµ‹è¯„æƒç›Šè¯´æ˜</h3>
            <ul class="feature-list">
                <li>è£æ ¼å¿ƒç†åŸå‹ 4ç»´åº¦åˆ†æ</li>
                <li>ç”Ÿæˆä½ çš„ <strong style="color:var(--primary)">å…‰é¢å¤©èµ‹</strong> (å…è´¹æŸ¥çœ‹)</li>
                <li>æ­ç§˜ä½ çš„ <strong style="color:#D35400">é˜´æš—é¢äººæ ¼</strong> (é™æ—¶Â¥2.99è§£é”)</li>
                <li>è·å– <strong style="color:#D35400">çµé­‚ä¼´ä¾£/å¤©æ•Œå…‹æ˜Ÿå›¾é‰´</strong> (è§£é”åèµ é€)</li>
            </ul>
        </div>

        <div class="input-group">
            <input type="text" id="cardCode" placeholder="è¯·è¾“å…¥æµ‹è¯„å¡å·" maxlength="20">
            <div id="errorMessage" style="color:red; font-size:12px; margin-top:5px; display:none;"></div>
        </div>

        <button class="btn-start" onclick="verifyCard()">ğŸŒ¿ å¼€å¯æ¢ç´¢ä¹‹æ—…</button>
        <div style="text-align:center; margin-top:20px; font-size:12px; color:#ccc; cursor:pointer;" onclick="showAdminPanel()">ç®¡ç†å‘˜å…¥å£</div>
    </div>

    <div id="testPage" class="card hidden">
        <div style="display:flex; justify-content:space-between; color:#999; font-size:13px; margin-bottom:5px;">
            <span id="progressText">è¿›åº¦ 1/40</span>
            <span>ç›´è§‰é€‰æ‹©</span>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="question-text" id="questionText"></div>
        <div id="options"></div>
        <div class="nav-buttons">
            <button class="nav-btn btn-prev" onclick="prevQ()" id="prevBtn" style="visibility:hidden">ä¸Šä¸€é¢˜</button>
            <button class="nav-btn btn-next" onclick="nextQ()">ä¸‹ä¸€é¢˜</button>
        </div>
    </div>

    <div id="resultPage" class="card hidden" style="padding:0;">
        <div class="result-header">
            <div style="opacity:0.8; font-size:12px;">ä½ çš„çµé­‚åŠ¨ç‰©æ˜¯</div>
            <div id="resultAnimal" class="animal-badge">ğŸ¦</div>
            <h2 id="resultTitle" class="res-title">é¢†è¢–ç‹®</h2>
            <div id="resultTags" class="res-tag">æ”¯é…å‹ | ç‹¬ç«‹å‹ | è°‹ç•¥å‹</div>
        </div>

        <div style="padding: 0 20px 20px 20px;">
            <div class="light-side">
                <div style="text-align:center; margin-bottom:10px; margin-top:5px;">
                    <span style="background:var(--primary); color:white; padding:2px 10px; border-radius:10px; font-size:12px;">âœ¨ ä½ çš„å…‰é¢å¤©èµ‹</span>
                </div>
                
                <canvas id="radarChart" style="max-height:220px; margin-bottom:15px;"></canvas>

                <div class="score-grid">
                    <div class="score-item-mini"><span class="si-name">æ”¯é…åŠ›</span><span class="si-val" id="score_0">--</span></div>
                    <div class="score-item-mini"><span class="si-name">ç‹¬ç«‹æ€§</span><span class="si-val" id="score_1">--</span></div>
                    <div class="score-item-mini"><span class="si-name">æœºæ™ºåº¦</span><span class="si-val" id="score_2">--</span></div>
                    <div class="score-item-mini"><span class="si-name">çµæ´»æ€§</span><span class="si-val" id="score_3">--</span></div>
                </div>

                <div class="free-card">
                    <div class="free-title">ğŸŒŸ æ ¸å¿ƒä¼˜åŠ¿ï¼š<span id="coreStrength">--</span></div>
                    
                    <div class="tags-cloud" id="freeTags"></div>
                    
                    <div class="free-text" id="freeAnalysis"></div>

                    <div class="gallery-box">
                        <div class="gallery-title">ğŸ” 16å‹åŠ¨ç‰©äººæ ¼å…¨å›¾é‰´ (ä½ åœ¨è¿™é‡Œ)</div>
                        <div class="animal-grid" id="fullGallery"></div>
                    </div>
                </div>
            </div>

            <div class="countdown-bar">
                ğŸ”¥ é™æ—¶ç‰¹æƒ å€’è®¡æ—¶ï¼š<span id="countdown">15:00</span>
            </div>

            <div class="blur-container">
                <div class="blur-content">
                    <h4>ğŸŒ‘ æ½œåœ¨çš„æ€§æ ¼é»‘æ´</h4>
                    <p>åœ¨å‹åŠ›çŠ¶æ€ä¸‹ï¼Œä½ å®¹æ˜“è¡¨ç°å‡º...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰</p>
                    <p>è¿™ä¼šå¯¼è‡´ä½ åœ¨äº²å¯†å…³ç³»ä¸­...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰</p>
                    <h4>ğŸ’” ç¤¾äº¤æ­»ç©´é¢„è­¦</h4>
                    <p>ä½ æœ€å®¹æ˜“å¾—ç½ªè¿™ç±»äºº...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰</p>
                    <h4>â¤ï¸ è°æ˜¯ä½ çš„çµé­‚ä¼´ä¾£ï¼Ÿ</h4>
                    <p>æœ€é€‚åˆä½ çš„äººæ ¼ç±»å‹æ˜¯...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰</p>
                </div>
                <div class="lock-overlay">
                    <button class="unlock-btn" onclick="scrollToPay()">
                        <span>ğŸ”“</span> è§£é”å®Œæ•´æ·±åº¦æŠ¥å‘Š Â¥2.99
                    </button>
                </div>
            </div>

            <div id="paySection" class="pay-panel">
                <div style="font-size:16px; font-weight:bold; color:#333; margin-bottom:10px;">è§£é”å®Œæ•´åŠ¨ç‰©äººæ ¼æŠ¥å‘Š + æ·±åº¦è§£æ</div>
                <div>
                    <span class="price-main">Â¥2.99</span>
                    <span style="text-decoration:line-through; color:#999;">Â¥59.9</span>
                </div>
                
                <div style="font-size:14px; color:#333; margin:15px 0;">ğŸ’³ é€‰æ‹©å¿«æ·æ”¯ä»˜</div>
                <button class="quick-btn btn-ali" onclick="aliPay()">âš¡ æ”¯ä»˜å®è·³è½¬æ”¯ä»˜</button>
                <button class="quick-btn btn-wx" onclick="scrollToQR()">âš¡ å¾®ä¿¡å¿«æ·æ”¯ä»˜</button>
                
                <div style="display:flex; align-items:center; margin:20px 0; color:#ccc; font-size:12px;">
                    <div style="flex:1; height:1px; background:#eee;"></div>
                    <div style="padding:0 10px;">æˆ–æ‰«ç  / è½¬è´¦</div>
                    <div style="flex:1; height:1px; background:#eee;"></div>
                </div>

                <div class="qr-row">
                    <div class="qr-wrap">
                        <div class="qr-label" style="background:#07C160;">æ¨èå¾®ä¿¡</div>
                        <img src="wechat_qrcode.jpg" class="qr-img">
                    </div>
                    <div class="qr-wrap">
                        <div class="qr-label" style="background:#1677FF;">æ”¯ä»˜å®</div>
                        <img src="alipay_qrcode.png" class="qr-img">
                    </div>
                </div>
                <div style="font-size:12px; color:#999;">ğŸ’¡ æˆªå›¾ä¿å­˜ -> æ‰“å¼€APPæ‰«ä¸€æ‰«</div>

                <div class="copy-row" style="margin-top:20px;"><span>å¾®ä¿¡ï¼šhch91178</span><button class="copy-btn-sm" onclick="copyTxt('hch91178')">å¤åˆ¶</button></div>
                <div class="copy-row"><span>æ”¯ä»˜å®ï¼š313360631@qq.com</span><button class="copy-btn-sm" onclick="copyTxt('313360631@qq.com')">å¤åˆ¶</button></div>

                <label for="fileInput" class="upload-btn">ğŸ“¸ ä¸Šä¼ æˆªå›¾ï¼Œè‡ªåŠ¨å‡ºæŠ¥å‘Š</label>
                <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="handleUpload(event)">
                
                <div class="after-pay-guide">
                    <strong>â“ å¦‚ä½•è·å–ï¼Ÿ</strong><br>1. ä»˜æ¬¾æˆªå›¾ â†’ 2. ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ä¸Šä¼  â†’ 3. è‡ªåŠ¨è·³è½¬
                </div>
            </div>

            <div class="recruit-card">
                <div style="font-weight:bold; color:#2D6A4F; margin-bottom:5px;">ğŸ“¢ æ‹›å¿ƒç†æµ‹è¯•é¡¹ç›®å­¦å¾’</div>
                <div style="color:#666; font-size:13px;">é¡¹ç›®å®æ“ Â· æµé‡å˜ç° Â· é•¿æœŸå¸¦æ•™</div>
                <div class="recruit-copy-box">
                    <span style="font-weight:bold; color:#333;">HCH91178</span>
                    <span style="color:#999; font-size:12px;">(å¤‡æ³¨:å­¦ä¹ æµ‹è¯•)</span>
                    <button class="copy-btn-sm" onclick="copyWx()" style="background:#FF9800;">å¤åˆ¶</button>
                </div>
            </div>
        </div>
    </div>

    <div id="fullReportPage" class="card hidden">
        <div class="result-header" style="background: linear-gradient(135deg, #D35400 0%, #E67E22 100%);">
            <div style="font-size:14px; opacity:0.9;">ğŸ”’ è§£é”æˆåŠŸ</div>
            <h2 style="margin-top:5px; font-size:24px;">æ·±åº¦äººæ ¼è§£æä¹¦</h2>
            <div style="font-size:12px;">ä¸“å±å®šåˆ¶ Â· ç»ˆèº«å—ç”¨</div>
        </div>

        <div style="padding: 20px;">
            <div id="fullReportContent">
                </div>

            <div class="recruit-card">
                <div style="font-weight:bold; color:#2D6A4F; margin-bottom:5px;">ğŸ“¢ æ‹›å¿ƒç†æµ‹è¯•é¡¹ç›®å­¦å¾’</div>
                <div style="color:#666; font-size:13px;">é¡¹ç›®å®æ“ Â· æµé‡å˜ç° Â· é•¿æœŸå¸¦æ•™</div>
                <div class="recruit-copy-box">
                    <span style="font-weight:bold; color:#333;">HCH91178</span>
                    <span style="color:#999; font-size:12px;">(å¤‡æ³¨:å­¦ä¹ æµ‹è¯•)</span>
                    <button class="copy-btn-sm" onclick="copyWx()" style="background:#FF9800;">å¤åˆ¶</button>
                </div>
            </div>
            
            <div style="text-align:center; padding-top:20px; color:#999; font-size:12px;">
                å®¢æœå¾®ä¿¡ï¼šHCH91178
            </div>
        </div>
    </div>
    
    <div id="adminPage" class="card hidden">
        <h3 style="margin-bottom:15px; color:#333;">ç®¡ç†å‘˜åå°</h3>
        <input type="password" id="adminPwd" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç " style="width:100%; padding:10px; margin-bottom:10px; border:1px solid #ccc; border-radius:5px;">
        <button onclick="checkAdmin()" class="btn-start" style="padding:10px; font-size:16px;">ç™»å½•åå°</button>
        
        <div id="adminContent" style="margin-top:20px; display:none;">
            <div class="admin-box" style="border-left:4px solid #D4AF37;">
                <h4 style="margin-bottom:10px; color:#333;">ğŸ› ï¸ å¡å·ç”Ÿæˆå™¨ (è‡ªåŠ¨å¯¼å‡ºTXT)</h4>
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <input type="number" id="genCount" placeholder="æ•°é‡(1-1000)" min="1" max="1000" style="flex:1; padding:8px; border:1px solid #ccc; border-radius:4px;">
                    <button onclick="generateAndExport()" class="admin-btn">ç”Ÿæˆå¹¶å¯¼å‡º</button>
                </div>
                
                <p style="font-size:12px; color:#D35400; margin-top:5px; margin-bottom:10px;">âœ… æç¤ºï¼šç”Ÿæˆçš„å¡å·è‡ªå¸¦é˜²ä¼ªéªŒè¯ï¼Œä¼šç›´æ¥ä¿å­˜ä¸ºTXTæ–‡ä»¶ã€‚</p>
                
                <h5 style="margin-top:15px; font-size:13px; color:#666;">ğŸ“œ ç”Ÿæˆè®°å½• (æœ¬æ¬¡ç™»å½•)</h5>
                <div id="logArea" class="log-list">
                    <div class="log-item" style="justify-content:center; color:#ccc;">æš‚æ— è®°å½•</div>
                </div>
            </div>
        </div>
        
        <button onclick="location.reload()" style="margin-top:20px; border:none; background:none; color:#666;">è¿”å›ä¸»é¡µ</button>
    </div>

</div>

<script>
    // ================= é…ç½®åŒº =================
    const CONFIG = {
        MASTER_CODE: "GEMINI-MASTER", // è¶…çº§ç®¡ç†å‘˜å¡å·
        ADMIN_PWD: "lss900201",       // ç®¡ç†å‘˜å¯†ç 
        SERVER_KEY: "SCT303445TGU9j8Q5VLg6rT7eryLe8L41v",
        ALIPAY_URL: "https://qr.alipay.com/tsx15981nt9c4aydmvo2h3d"
    };

    // ================= æ—§å¡å·ä¿ç•™åŒº =================
    const LEGACY_DATABASE = [
        "GEMINI-MASTER", 
        "VIP8888",        
        "SVIP666",        
        "TEST2026",
    ];

    const dimensionNames = ['æ”¯é…/éšå’Œ', 'ç‹¬ç«‹/åˆç¾¤', 'æœºæ™º/å¿ è¯š', 'çµæ´»/è§„å¾‹'];
    
    // åŸºç¡€æ•°æ®
    const animalTypes = {
        'LYJG': { name: 'é¢†è¢–ç‹®', icon: 'ğŸ¦', desc: 'å¤©ç”Ÿçš„é¢†å¯¼è€…ï¼Œè‡ªä¿¡ã€æœæ–­ã€æœºæ™ºä¸”çµæ´»ï¼Œæ˜¯æŒæ§å…¨å±€çš„ç‹è€…ã€‚', tags: ['#æ°”åœºå¼ºå¤§', '#ç›®æ ‡å¯¼å‘', '#æŒæ§å…¨å±€'] },
        'LYJL': { name: 'æˆ˜ç•¥ç‹', icon: 'ğŸ¦Š', desc: 'ç‹¬ç«‹ã€æœºæ™ºã€æœ‰è¿œè§ï¼Œåƒç‹ç‹¸ä¸€æ ·æ€»èƒ½æ‰¾åˆ°æœ€ä½³è·¯å¾„ã€‚', tags: ['#è¶³æ™ºå¤šè°‹', '#ç‹¬ç«‹æ€è€ƒ', '#ç­–ç•¥ä¸“å®¶'] },
        'LYZG': { name: 'æ€»æŒ‡æŒ¥é¹°', icon: 'ğŸ¦…', desc: 'æ”¯é…ã€ç‹¬ç«‹ã€å¿ è¯šä¸”è§„å¾‹ï¼Œæ˜¯é«˜ç»è¿œç©çš„æˆ˜ç•¥å®¶ã€‚', tags: ['#ç›®å…‰é•¿è¿œ', '#æåº¦è‡ªå¾‹', '#æ„å¿—åšå®š'] },
        'LYZL': { name: 'ç‹¬è¡Œç‹®', icon: 'ğŸ¦', desc: 'è‡ªä¿¡ã€ç‹¬ç«‹ã€å¿ è¯šä½†éšæ€§ï¼Œæ˜¯å……æ»¡é­…åŠ›çš„ç‹¬è¡Œé¢†è¢–ã€‚', tags: ['#ç‹¬æ¥ç‹¬å¾€', '#ä¸ªäººè‹±é›„', '#ä¸ç¾'] },
        'LGJG': { name: 'è¡¨æ¼”è€…çŒ´', icon: 'ğŸ’', desc: 'æ”¯é…ã€åˆç¾¤ã€æœºæ™ºä¸”è§„å¾‹ï¼Œæ˜¯èˆå°ä¸­å¿ƒçš„æ˜æ˜Ÿã€‚', tags: ['#æ´»åŠ›å››å°„', '#å¹½é»˜é£è¶£', '#ç¤¾äº¤è¾¾äºº'] },
        'LGJL': { name: 'å†’é™©å®¶ç‹¼', icon: 'ğŸº', desc: 'æ”¯é…ã€åˆç¾¤ã€æœºæ™ºä¸”çµæ´»ï¼Œæ˜¯ç‹¼ç¾¤ä¸­æ— ç•çš„æ¢è·¯è€…ã€‚', tags: ['#å›¢é˜Ÿåä½œ', '#å‹‡äºå†’é™©', '#é€‚åº”åŠ›å¼º'] },
        'LGZG': { name: 'ç®¡ç†è€…èœ‚', icon: 'ğŸ', desc: 'æ”¯é…ã€åˆç¾¤ã€å¿ è¯šä¸”è§„å¾‹ï¼Œæ˜¯é«˜æ•ˆçš„ç»„ç»‡è€…å’Œç®¡ç†è€…ã€‚', tags: ['#äº•äº•æœ‰æ¡', '#å‹¤å¥‹è¸å®', '#å®Œç¾æ‰§è¡Œ'] },
        'LGZL': { name: 'æå«è€…ç†Š', icon: 'ğŸ»', desc: 'æ”¯é…ã€åˆç¾¤ã€å¿ è¯šä½†çµæ´»ï¼Œæ˜¯å›¢é˜Ÿä¸­å¼ºå¤§çš„å®ˆæŠ¤è€…ã€‚', tags: ['#å®ˆæŠ¤åŠ›max', '#æ­£ä¹‰æ„Ÿ', '#å€¼å¾—ä¿¡èµ–'] },
        'SYJG': { name: 'æ™ºè€…çŒ«å¤´é¹°', icon: 'ğŸ¦‰', desc: 'éšå’Œã€ç‹¬ç«‹ã€æœºæ™ºä¸”è§„å¾‹ï¼Œæ˜¯æ·±å¤œä¸­æ€è€ƒçš„æ™ºè€…ã€‚', tags: ['#æ·±åº¦æ€è€ƒ', '#å†·é™ç†æ™º', '#æ´å¯ŸåŠ›'] },
        'SYJL': { name: 'è‰ºæœ¯å®¶çŒ«', icon: 'ğŸ±', desc: 'éšå’Œã€ç‹¬ç«‹ã€æœºæ™ºä¸”çµæ´»ï¼Œæ˜¯ä¼˜é›…ä¸”éš¾ä»¥æ‰æ‘¸çš„è‰ºæœ¯å®¶ã€‚', tags: ['#ç‰¹ç«‹ç‹¬è¡Œ', '#çµæ„Ÿä¸°å¯Œ', '#ç¥ç§˜ä¼˜é›…'] },
        'SYZG': { name: 'å®ˆæŠ¤è€…è€ƒæ‹‰', icon: 'ğŸ¨', desc: 'éšå’Œã€ç‹¬ç«‹ã€å¿ è¯šä¸”è§„å¾‹ï¼Œæ˜¯æ¸©å’Œè€Œåšå®šçš„å®ˆæŠ¤è€…ã€‚', tags: ['#æƒ…ç»ªç¨³å®š', '#ä¸ä¸–æ— äº‰', '#å†…å¿ƒåšéŸ§'] },
        'SYZL': { name: 'æµæµªè€…é¹¿', icon: 'ğŸ¦Œ', desc: 'éšå’Œã€ç‹¬ç«‹ã€å¿ è¯šä½†çµæ´»ï¼Œæ˜¯æ£®æ—ä¸­ä¼˜é›…çš„ç‹¬è¡Œè€…ã€‚', tags: ['#å‘å¾€è‡ªç”±', '#æ•æ„Ÿç»†è…»', '#å’Œå¹³ä¸»ä¹‰'] },
        'SGJG': { name: 'åè°ƒè€…æµ·è±š', icon: 'ğŸ¬', desc: 'éšå’Œã€åˆç¾¤ã€æœºæ™ºä¸”è§„å¾‹ï¼Œæ˜¯å›¢é˜Ÿä¸­çš„â€œç²˜åˆå‰‚â€ã€‚', tags: ['#é«˜æƒ…å•†', '#å–„è§£äººæ„', '#å’Œè°'] },
        'SGJL': { name: 'å¿«ä¹æ°´è±š', icon: 'ğŸ¦¦', desc: 'éšå’Œã€åˆç¾¤ã€æœºæ™ºä¸”çµæ´»ï¼Œæ˜¯äººè§äººçˆ±çš„ç¤¾äº¤è¾¾äººã€‚', tags: ['#æƒ…ç»ªç¨³å®š', '#ä¸‡èƒ½æœ‹å‹', '#æ¾å¼›æ„Ÿ'] },
        'SGZG': { name: 'å®ˆæŠ¤è€…çŠ¬', icon: 'ğŸ¶', desc: 'éšå’Œã€åˆç¾¤ã€å¿ è¯šä¸”è§„å¾‹ï¼Œæ˜¯äººç±»æœ€å¿ å®å¯é çš„æœ‹å‹ã€‚', tags: ['#ç»å¯¹å¿ è¯š', '#è´£ä»»å¿ƒå¼º', '#æœ€ä½³é˜Ÿå‹'] },
        'SGZL': { name: 'å’Œå¹³é¸½', icon: 'ğŸ•Šï¸', desc: 'éšå’Œã€åˆç¾¤ã€å¿ è¯šä½†çµæ´»ï¼Œæ˜¯å¸¦æ¥å’Œå¹³ä¸å…³çˆ±çš„ä½¿è€…ã€‚', tags: ['#æ¸©æŸ”å–„è‰¯', '#æ²»æ„ˆç³»', '#åˆ©ä»–ä¸»ä¹‰'] }
    };

    const questions = [
        {text: 'åœ¨å›¢é˜Ÿè®¨è®ºä¸­ï¼Œæˆ‘å€¾å‘äºä¸»å¯¼è¯é¢˜å¹¶åšå‡ºæœ€ç»ˆå†³å®šã€‚', dimension: 0},
        {text: 'æˆ‘æ›´å–œæ¬¢æ‰®æ¼”é¢†å¯¼è€…ï¼Œè€Œä¸æ˜¯è¿½éšè€…ã€‚', dimension: 0},
        {text: 'ä¸ºäº†å›¢é˜Ÿå’Œè°ï¼Œæˆ‘æ„¿æ„æ”¾å¼ƒè‡ªå·±çš„è§‚ç‚¹ã€‚', dimension: 0, reverse: true},
        {text: 'æˆ‘å–œæ¬¢æœ‰æ¡ç†ã€æœ‰è®¡åˆ’åœ°ç”Ÿæ´»ã€‚', dimension: 3}, 
        {text: 'åˆ«äººé€šå¸¸è®¤ä¸ºæˆ‘æ˜¯ä¸€ä¸ªå¼ºåŠ¿ã€æœ‰ä¸»è§çš„äººã€‚', dimension: 0},
        {text: 'æˆ‘å®æ„¿è‡ªå·±åšå†³å®šï¼Œå³ä½¿é”™äº†ä¹Ÿæ— æ‰€è°“ã€‚', dimension: 0},
        {text: 'æˆ‘å¾ˆéš¾å¯¹åˆ«äººçš„è¯·æ±‚è¯´â€œä¸â€ã€‚', dimension: 0, reverse: true},
        {text: 'æˆ‘è®¤ä¸ºè§„åˆ™å’Œç§©åºæ˜¯æˆåŠŸçš„ç¬¬ä¸€è¦ç´ ã€‚', dimension: 3},
        {text: 'æˆ‘å–œæ¬¢ç«äº‰ï¼Œå¹¶äº«å—èƒœåˆ©çš„å¿«æ„Ÿã€‚', dimension: 0},
        {text: 'æˆ‘æ›´çœ‹é‡å›¢é˜Ÿçš„å’Œè°ï¼Œè€Œä¸æ˜¯ä¸ªäººçš„èƒœåˆ©ã€‚', dimension: 1, reverse: true}, 
        {text: 'æˆ‘æ›´å–œæ¬¢ä¸€ä¸ªäººç‹¬å¤„ï¼Œè€Œä¸æ˜¯å‚åŠ çƒ­é—¹çš„èšä¼šã€‚', dimension: 1}, 
        {text: 'å¯¹æˆ‘æ¥è¯´ï¼Œæ‹¥æœ‰æ·±å…¥çš„ç§äººç©ºé—´å’Œæ—¶é—´éå¸¸é‡è¦ã€‚', dimension: 1},
        {text: 'æˆ‘å¾ˆå®¹æ˜“å’Œé™Œç”Ÿäººæ‰“æˆä¸€ç‰‡ã€‚', dimension: 1, reverse: true},
        {text: 'æˆ‘åšå†³å®šæ—¶ï¼Œå¾ˆå°‘éœ€è¦å¾æ±‚ä»–äººçš„æ„è§ã€‚', dimension: 1},
        {text: 'æˆ‘å®æ„¿åœ¨ä¸€ä¸ªå°å›¢é˜Ÿé‡Œå·¥ä½œï¼Œä¹Ÿä¸æ„¿ç‹¬è‡ªæ‰¿æ‹…é¡¹ç›®ã€‚', dimension: 1, reverse: true},
        {text: 'æˆ‘äº«å—æˆä¸ºä¼—äººç©ç›®çš„ç„¦ç‚¹ã€‚', dimension: 1, reverse: true},
        {text: 'æˆ‘å€¾å‘äºé€šè¿‡å†…éƒ¨åæ€æ¥è§£å†³é—®é¢˜ã€‚', dimension: 1},
        {text: 'æˆ‘çš„äººé™…ç½‘ç»œå¾ˆå¹¿ï¼Œæœ‰å¾ˆå¤šæœ‹å‹ã€‚', dimension: 1, reverse: true},
        {text: 'é•¿æ—¶é—´çš„ç¤¾äº¤æ´»åŠ¨ä¼šè®©æˆ‘æ„Ÿåˆ°ç²¾ç–²åŠ›å°½ã€‚', dimension: 1},
        {text: 'æˆ‘æ›´åƒä¸€ä¸ªâ€œç‹¬è¡Œä¾ â€ã€‚', dimension: 1},
        {text: 'æˆ‘æ“…é•¿å‘ç°è§„åˆ™çš„æ¼æ´å¹¶åˆ©ç”¨å®ƒä»¬ã€‚', dimension: 2}, 
        {text: 'åœ¨å›°å¢ƒä¸­ï¼Œæˆ‘æ€»èƒ½æƒ³å‡ºå·§å¦™çš„åŠæ³•è§£å†³é—®é¢˜ã€‚', dimension: 2},
        {text: 'æˆ‘éå¸¸çœ‹é‡æ‰¿è¯ºå’Œèª“è¨€ï¼Œä¸€æ—¦ç­”åº”å°±ä¸€å®šä¼šåšåˆ°ã€‚', dimension: 2, reverse: true}, 
        {text: 'æˆ‘è®¤ä¸ºâ€œå¿ è¯šâ€æ¯”â€œèªæ˜â€æ›´é‡è¦ã€‚', dimension: 2, reverse: true},
        {text: 'æˆ‘å–œæ¬¢å˜åŒ–å’Œæ–°å¥‡ï¼Œè®¨åŒä¸€æˆä¸å˜ã€‚', dimension: 2},
        {text: 'æˆ‘æ˜¯ä¸€ä¸ªéå¸¸å¯é çš„äººï¼Œæœ‹å‹ä»¬éƒ½ä¿¡ä»»æˆ‘ã€‚', dimension: 2, reverse: true},
        {text: 'æˆ‘èƒ½è½»æ˜“å¯Ÿè§‰åˆ°åˆ«äººçš„çœŸå®æ„å›¾ã€‚', dimension: 2},
        {text: 'æˆ‘å€¾å‘äºåšæŒä¼ ç»Ÿå’Œå·²ç»éªŒè¯è¿‡çš„æ–¹æ³•ã€‚', dimension: 2, reverse: true},
        {text: 'æˆ‘å–œæ¬¢å³å…´å‘æŒ¥ï¼Œè€Œä¸æ˜¯ç…§æœ¬å®£ç§‘ã€‚', dimension: 2},
        {text: 'æˆ‘å¯¹æˆ‘çš„å›¢é˜Ÿæˆ–ç»„ç»‡æœ‰æé«˜çš„å½’å±æ„Ÿå’Œå¿ è¯šåº¦ã€‚', dimension: 2, reverse: true},
        {text: 'æˆ‘å–œæ¬¢çªå¦‚å…¶æ¥çš„æ—…è¡Œï¼Œè€Œä¸æ˜¯æå‰å‡ ä¸ªæœˆåšè®¡åˆ’ã€‚', dimension: 3}, 
        {text: 'æˆ‘æ›´å–œæ¬¢çµæ´»çš„å·¥ä½œæ—¶é—´ï¼Œè€Œä¸æ˜¯æœä¹æ™šäº”ã€‚', dimension: 3},
        {text: 'æˆ‘æ¯å¤©çš„ç”Ÿæ´»éƒ½éå¸¸æœ‰è§„å¾‹ï¼Œæœ‰å›ºå®šçš„ä½œæ¯è¡¨ã€‚', dimension: 3, reverse: true},
        {text: 'æˆ‘åšäº‹å–œæ¬¢éšæ€§è€Œä¸ºï¼Œè·Ÿç€æ„Ÿè§‰èµ°ã€‚', dimension: 3},
        {text: 'æˆ‘è®¨åŒæƒŠå–œï¼Œå–œæ¬¢ä¸€åˆ‡å°½åœ¨æŒæ¡ã€‚', dimension: 3, reverse: true},
        {text: 'æˆ‘çš„åŠå…¬æ¡Œæˆ–æˆ¿é—´æ€»æ˜¯äº•äº•æœ‰æ¡ã€‚', dimension: 3, reverse: true},
        {text: 'æˆ‘ç»å¸¸ä¼šæœ€åä¸€åˆ†é’Ÿæ‰å®Œæˆä»»åŠ¡ã€‚', dimension: 3},
        {text: 'æˆ‘äº«å—æ‚ é—²çš„ç”Ÿæ´»ï¼Œä¸å–œæ¬¢è¢«æ—¥ç¨‹è¡¨æŸç¼šã€‚', dimension: 3},
        {text: 'æˆ‘æ˜¯ä¸€ä¸ªâ€œæ´»åœ¨å½“ä¸‹â€çš„äººã€‚', dimension: 3},
        {text: 'æˆ‘å€¾å‘äºå…ˆå®Œæˆå·¥ä½œï¼Œå†äº«å—å¨±ä¹ã€‚', dimension: 3, reverse: true}
    ];

    let state = { qIdx: 0, ans: [], code: '' };

    // ================= æ ¸å¿ƒï¼šç®—æ³•éªŒè¯ç³»ç»Ÿ =================
    const SALT = "HCH_SECRET_2026"; 

    function isCodeValid(code) {
        if(!code) return false;
        if(LEGACY_DATABASE.includes(code)) return true;
        const parts = code.split('-');
        if(parts.length !== 3 || parts[0] !== 'VIP') return false;
        const randomPart = parts[1]; 
        const checkSum = parts[2]; 
        return generateChecksum(randomPart) === checkSum;
    }

    function generateChecksum(str) {
        let hash = 0;
        const mix = str + SALT;
        for (let i = 0; i < mix.length; i++) {
            hash = (hash << 5) - hash + mix.charCodeAt(i);
            hash |= 0; 
        }
        let hex = Math.abs(hash).toString(16);
        return hex.substring(hex.length-2).toUpperCase();
    }

    function verifyCard() {
        const c = document.getElementById('cardCode').value.trim();
        const errorMsg = document.getElementById('errorMessage');
        
        if(!c) {
            errorMsg.innerText = 'âš ï¸ è¯·è¾“å…¥æµ‹è¯„å¡å·';
            errorMsg.style.display = 'block';
            return;
        }
        if (!isCodeValid(c)) {
            errorMsg.innerText = 'âŒ æ— æ•ˆçš„å¡å·ï¼Œè¯·è”ç³»å®¢æœè·å–';
            errorMsg.style.display = 'block';
            return;
        }

        state.code = c;
        document.getElementById('verifyPage').classList.add('hidden');
        document.getElementById('testPage').classList.remove('hidden');
        renderQ();
    }

    // ================= é¡µé¢é€»è¾‘ =================
    function renderQ() {
        const q = questions[state.qIdx];
        document.getElementById('questionText').innerText = `${state.qIdx+1}. ${q.text}`;
        document.getElementById('progressText').innerText = `è¿›åº¦ ${state.qIdx+1}/40`;
        document.getElementById('progressFill').style.width = ((state.qIdx+1)/40*100)+'%';
        
        document.getElementById('prevBtn').style.visibility = state.qIdx===0?'hidden':'visible';
        
        let h='';
        ['å®Œå…¨ä¸ç¬¦','ä¸å¤ªç¬¦åˆ','ä¸€èˆ¬','æ¯”è¾ƒç¬¦åˆ','éå¸¸ç¬¦åˆ'].forEach((t,i)=>{
            const s = state.ans[state.qIdx]===i?'selected':'';
            h+=`<div class="option ${s}" onclick="sel(${i})">${t}</div>`;
        });
        document.getElementById('options').innerHTML=h;
    }

    function sel(v) {
        state.ans[state.qIdx] = v;
        renderQ();
        setTimeout(()=>nextQ(true), 200);
    }

    function nextQ(auto=false) {
        if(!auto && state.ans[state.qIdx]===undefined) return alert('è¯·é€‰æ‹©');
        if(auto && state.ans[state.qIdx]===undefined) return;
        if(state.qIdx<39) { state.qIdx++; renderQ(); }
        else calc();
    }

    function prevQ() { if(state.qIdx>0) {state.qIdx--; renderQ();} }

    function calc() {
        let scores = [0,0,0,0];
        questions.forEach((q,i)=>{
            let v = state.ans[i]||0;
            if(q.reverse) v = 4 - v; 
            scores[q.dimension] += (v+1); 
        });
        
        let typeCode = "";
        typeCode += scores[0] >= 30 ? "L" : "S"; 
        typeCode += scores[1] >= 30 ? "Y" : "G"; 
        typeCode += scores[2] >= 30 ? "J" : "Z"; 
        typeCode += scores[3] >= 30 ? "L" : "G";
        
        const displayScores = scores.map(s => Math.round(s/50*20));
        const animal = animalTypes[typeCode] || animalTypes['SGZL'];
        window.res = {displayScores, animal, typeCode, rawScores: scores};
        showFree();
    }

    function showFree() {
        const {displayScores, animal, typeCode} = window.res;
        document.getElementById('testPage').classList.add('hidden');
        document.getElementById('resultPage').classList.remove('hidden');
        
        document.getElementById('resultAnimal').innerText = animal.icon;
        document.getElementById('resultTitle').innerText = animal.name;
        document.getElementById('resultTags').innerText = typeCode;
        document.getElementById('coreStrength').innerText = animal.desc.split('ï¼Œ')[0];
        
        let tagHtml = '';
        (animal.tags || []).forEach(tag => { tagHtml += `<span class="tag-pill">${tag}</span>`; });
        document.getElementById('freeTags').innerHTML = tagHtml;

        const analysisText = `
            <p><strong>åŸºç¡€äººæ ¼ç”»åƒï¼š</strong><br>æ•°æ®æ¨¡å‹æ˜¾ç¤ºï¼Œæ‚¨å±äºå…¸å‹çš„<strong>ã€${animal.name}ã€‘</strong>ã€‚åœ¨å››ç»´åæ ‡ç³»ä¸­ï¼Œæ‚¨å±•ç°å‡ºäº†${typeCode.includes('L')?'è¾ƒå¼ºçš„æ”¯é…æ¬²ä¸æŒæ§åŠ›':'æ¸©å’Œéšå’Œçš„å¤„ä¸–æ€åº¦'}ï¼ŒåŒæ—¶${typeCode.includes('Y')?'äº«å—ç‹¬ç«‹æ€è€ƒ':'ä¹äºèå…¥ç¾¤ä½“'}ã€‚</p>
            <p>è¿™ç§ç‹¬ç‰¹çš„æ€§æ ¼ç»„åˆï¼Œèµ‹äºˆäº†æ‚¨<span class="free-highlight">${animal.tags[0].replace('#','')}</span>çš„å¤©èµ‹ä¼˜åŠ¿ã€‚åœ¨é¡ºå¢ƒä¸­ï¼Œæ‚¨å¾€å¾€èƒ½å¦‚é±¼å¾—æ°´ï¼›ä½†åœ¨é«˜å‹ç¯å¢ƒä¸‹ï¼Œæ‚¨çš„æ½œæ„è¯†å¯èƒ½ä¼šè§¦å‘é˜²å¾¡æœºåˆ¶ï¼Œå¯¼è‡´...</p>
            <div style="background:#FFF3E0; color:#E65100; font-size:12px; padding:8px; border-radius:4px; margin-top:10px;">ğŸ‘‰ æƒ³è¦äº†è§£æ‚¨çš„â€œé˜²å¾¡æœºåˆ¶â€ä¸â€œç¤¾äº¤æ­»ç©´â€ï¼Ÿè¯·è§£é”æ·±åº¦æŠ¥å‘Šã€‚</div>
        `;
        document.getElementById('freeAnalysis').innerHTML = analysisText;

        let galleryHtml = '';
        Object.keys(animalTypes).forEach(key => {
            const item = animalTypes[key];
            const isActive = key === typeCode ? 'active' : '';
            galleryHtml += `
                <div class="animal-item ${isActive}">
                    <span class="ani-icon">${item.icon}</span>
                    <span class="ani-name">${item.name}</span>
                </div>
            `;
        });
        document.getElementById('fullGallery').innerHTML = galleryHtml;

        displayScores.forEach((s,i)=>{ document.getElementById(`score_${i}`).innerText = s + 'åˆ†'; });

        drawChart('radarChart', displayScores);
        startTimer(15*60);
        window.scrollTo(0,0);
    }

    function startTimer(d) {
        let t = d, m, s;
        setInterval(()=>{
            m = parseInt(t/60,10); s = parseInt(t%60,10);
            document.getElementById('countdown').innerText = `${m}:${s<10?'0'+s:s}`;
            if(--t<0) t=d;
        },1000);
    }

    function drawChart(id, s) {
        const ctx = document.getElementById(id);
        if(window.myChart) window.myChart.destroy();
        window.myChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: dimensionNames,
                datasets: [{
                    label: 'èƒ½é‡å€¼', data: s,
                    backgroundColor: 'rgba(45, 106, 79, 0.2)',
                    borderColor: '#2D6A4F', borderWidth: 2, pointBackgroundColor: '#2D6A4F'
                }]
            },
            options: {
                scales: { r: { min: 0, max: 20, ticks: {display: true, stepSize: 5}, pointLabels: {font: { size: 11 } } } },
                plugins: { legend: {display:false} }
            }
        });
    }

    function handleUpload(e) {
        if(e.target.files.length===0) return;
        document.querySelector('.upload-btn').innerText = 'â³ æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...';
        fetch(`https://sctapi.ftqq.com/${CONFIG.SERVER_KEY}.send`, {
            method:'POST', headers:{'Content-Type':'application/json'},
            body:JSON.stringify({title:'ğŸ’°æ–°è®¢å•-åŠ¨ç‰©å¡‘-2.99', desp:`å¡å·:${state.code}`})
        }).catch(()=>{});
        setTimeout(()=>{
            document.getElementById('resultPage').classList.add('hidden');
            document.getElementById('fullReportPage').classList.remove('hidden');
            showFull();
            window.scrollTo(0,0);
        },1500);
    }

    // === æ ¸å¿ƒä¿®æ”¹åŒºï¼šåŠ¨æ€ç”Ÿæˆæ·±åº¦æŠ¥å‘Š ===
    function showFull() {
        const {animal, typeCode} = window.res || {animal: animalTypes['SGZL'], typeCode: 'SGZL'}; 
        
        // 1. åŠ¨æ€è®¡ç®—ç‰¹è´¨æ–‡æ¡ˆ
        const isLeader = typeCode.includes('L'); // L=æ”¯é…, S=éšå’Œ
        const isIndependent = typeCode.includes('Y'); // Y=ç‹¬ç«‹, G=åˆç¾¤
        const isWitty = typeCode.includes('J'); // J=æœºæ™º, Z=å¿ è¯š
        const isFlexible = typeCode.includes('L') && typeCode.lastIndexOf('L')===3; // ä¿®æ­£é€»è¾‘, å‡è®¾æœ€åä¸€ä½æ˜¯L/G

        // 2. åŠ¨æ€ç”Ÿæˆçµé­‚ä¼´ä¾£å’Œå…‹æ˜Ÿ (ä½¿ç”¨ç³»ç»Ÿå†…å­˜åœ¨çš„åŠ¨ç‰©)
        // é€»è¾‘ï¼šä¼´ä¾£=äº’è¡¥(æ”¯é…ç›¸åï¼Œå…¶ä»–ç›¸ä¼¼)ï¼Œå…‹æ˜Ÿ=å†²çª(æ”¯é…ç›¸åŒä½†æ–¹æ³•ä¸åŒ)
        let soulmateCode = (isLeader ? 'S' : 'L') + typeCode.substring(1); 
        if(!animalTypes[soulmateCode]) soulmateCode = isLeader ? 'SGZG' : 'LYZG'; // å…œåº•: å®ˆæŠ¤çŠ¬ æˆ– è¿œè§é¹°
        
        let enemyCode = typeCode.substring(0,3) + (typeCode[3]==='L'?'G':'L');
        if(!animalTypes[enemyCode]) enemyCode = isLeader ? 'LGJG' : 'SYJL'; // å…œåº•: çŒ´ æˆ– çŒ«

        // æ˜ å°„ç”¨æˆ·æåˆ°çš„â€œé‡‘æ¯›/å¤§è±¡/å­”é›€â€åˆ°ç³»ç»Ÿå†…å­˜åœ¨çš„åŠ¨ç‰©
        const soulmateName = animalTypes[soulmateCode].name; // æ¯”å¦‚ "å®ˆæŠ¤çŠ¬" ä»£æ›¿ "é‡‘æ¯›"
        const enemyName = animalTypes[enemyCode].name;       // æ¯”å¦‚ "è¡¨æ¼”è€…çŒ´" ä»£æ›¿ "å­”é›€"

        const html = `
            <div class="report-section-new">
                <div class="rs-title"><span class="rs-icon">ğŸ§ </span> 01. æ½œæ„è¯†æ·±å±‚è§£ç </div>
                <div class="rs-content">
                    ä½ è¡¨é¢ä¸Šçœ‹èµ·æ¥${isLeader ? 'å¼ºåŠ¿è‡ªä¿¡' : 'æ¸©å’Œéšæ€§'}ï¼Œä½†æ½œæ„è¯†é‡Œä½ æåº¦æ¸´æœ›<strong>è¢«ç†è§£ä½†åˆå®³æ€•è¢«çœ‹ç©¿</strong>ã€‚ä½ çš„å¤§è„‘è¿ä½œæ¨¡å¼æ˜¯å…¸å‹çš„â€œå¤šçº¿ç¨‹å¤„ç†â€ï¼Œè¿™è®©ä½ åœ¨å±æœºæ—¶åˆ»èƒ½ä¿æŒå¼‚å¸¸çš„å†·é™ã€‚
                    <div class="highlight-box">
                        ğŸ’¡ <strong>æ ¸å¿ƒé©±åŠ¨åŠ›ï¼š</strong> ä¸æ˜¯é‡‘é’±ï¼Œè€Œæ˜¯â€œ${isLeader ? 'æŒæ§æ„Ÿ' : 'å®‰å…¨æ„Ÿ'}â€å’Œâ€œè‡ªæˆ‘å®ç°çš„è‡ªç”±â€ã€‚
                    </div>
                </div>
            </div>

            <div class="report-section-new">
                <div class="rs-title"><span class="rs-icon">ğŸŒ‘</span> 02. é˜´æš—é¢ä¸å‹åŠ›é¢„è­¦</div>
                <div class="warn-box">
                    âš ï¸ <strong>é«˜å±çŠ¶æ€ï¼š</strong><br>
                    å½“å‹åŠ›è¿‡å¤§æ—¶ï¼Œä½ ä¼šçªç„¶åˆ‡æ–­æ‰€æœ‰ç¤¾äº¤ï¼Œè¿›å…¥â€œæƒ…ç»ªä¼‘å…‹â€çŠ¶æ€ã€‚ä½ å®¹æ˜“å¯¹äº²è¿‘çš„äººè¡¨ç°å‡ºå†·æ¼ æˆ–è®½åˆºï¼Œè¿™æ˜¯ä½ ä¿æŠ¤è‡ªå·±è„†å¼±å†…æ ¸çš„é˜²å¾¡æœºåˆ¶ã€‚
                </div>
                <div class="rs-content" style="margin-top:12px;">
                    <p>ä½ çš„é˜´æš—é¢åœ¨äºâ€œ${isIndependent ? 'è¿‡åº¦ç†æ€§åŒ–' : 'è¿‡åº¦ä¾èµ–è®¤å¯'}â€ã€‚å½“åˆ«äººåœ¨è°ˆè®ºæ„Ÿæƒ…æ—¶ï¼Œä½ å¯èƒ½åœ¨${isIndependent ? 'åˆ†æåˆ©å¼Š' : 'æ‹…å¿ƒè¢«æŠ›å¼ƒ'}ã€‚</p>
                    
                    <div style="margin-top:15px; padding-top:10px; border-top:1px dashed #ddd;">
                        <strong>ğŸ›¡ï¸ é˜²å¾¡æœºåˆ¶ï¼š</strong><br>
                        ä½ ä¹ æƒ¯ç”¨${isWitty ? 'å¹½é»˜æˆ–å›é¿' : 'æ²‰é»˜æˆ–æ”»å‡»'}æ¥æ©é¥°ä¸å®‰ã€‚ä¸€æ—¦æ„Ÿåˆ°è¢«å†’çŠ¯ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯${isLeader ? 'åå‡»å›å»' : 'è¿…é€Ÿæ’¤é€€'}ã€‚
                    </div>
                    <div style="margin-top:10px;">
                        <strong>ğŸ’” ç¤¾äº¤æ­»ç©´ï¼š</strong><br>
                        ä½ æœ€å—ä¸äº†${isIndependent ? 'æƒ…ç»ªåŒ–ä¸”é€»è¾‘æ··ä¹±' : 'å†·æ¼ ä¸”é«˜é«˜åœ¨ä¸Š'}çš„äººï¼Œè¿™ä¼šç¬é—´å¼•çˆ†ä½ çš„${isLeader ? 'æ€’ç«' : 'ç„¦è™‘'}ã€‚
                    </div>
                </div>
            </div>

            <div class="report-section-new">
                <div class="rs-title"><span class="rs-icon">ğŸ’°</span> 03. èŒåœºè´¢å¯Œä¸ç”Ÿæ€ä½</div>
                <div class="rs-content">
                    ä½ ä¸é€‚åˆåšä¸€é¢—èºä¸é’‰ã€‚ä½ çš„è´¢å¯Œå¤©èµ‹åœ¨äº<strong>${isWitty ? 'æ•´åˆèµ„æº' : 'æ·±è€•ä¸“ä¸š'}</strong>å’Œ<strong>æ´å¯Ÿè¶‹åŠ¿</strong>ã€‚
                    <div style="margin-top:8px;">
                        <strong>âœ¨ æœ€ä½³ä½ç½®ï¼š</strong> ${isLeader ? 'é¡¹ç›®æ“ç›˜æ‰‹ã€ç‹¬ç«‹é¡¾é—®' : 'é«˜çº§ä¸“å®¶ã€æ ¸å¿ƒè¾…åŠ©'}ã€‚<br>
                        <strong>âœ¨ æé’±å»ºè®®ï¼š</strong> ä½ çš„ç›´è§‰å¾ˆå‡†ï¼Œå°è¯•é‚£äº›éœ€è¦â€œ${isIndependent ? 'èµŒä¸€æŠŠ' : 'é•¿æœŸåšæŒ'}â€ä½†æœ‰é€»è¾‘æ”¯æ’‘çš„é¢†åŸŸã€‚
                    </div>
                </div>
            </div>

            <div class="report-section-new">
                <div class="rs-title"><span class="rs-icon">â¤ï¸</span> 04. çµé­‚ä¼´ä¾£ä¸å¤©æ•Œ</div>
                <div class="rs-content">
                    <p>ğŸ’– <strong>ä½ çš„å®¿å‘½æ‹äººï¼š</strong> èƒ½å¤Ÿçœ‹ç©¿ä½ åšå¼ºå¤–è¡¨ä¸‹å­©å­æ°”ä¸€é¢çš„â€œ${animalTypes[soulmateCode].name}â€å‹äººæ ¼ï¼ˆ${animalTypes[soulmateCode].icon}ï¼‰ã€‚</p>
                    <p style="margin-top:8px;">â˜ ï¸ <strong>ä½ çš„å¤©ç”Ÿå…‹æ˜Ÿï¼š</strong> é‚£äº›è¿‡åº¦æƒ…ç»ªåŒ–ã€é€»è¾‘æ··ä¹±ä¸”è¯•å›¾æ§åˆ¶ä½ çš„äººï¼Œæ¯”å¦‚â€œ${animalTypes[enemyCode].name}â€ï¼ˆ${animalTypes[enemyCode].icon}ï¼‰ã€‚</p>
                </div>
            </div>

            <div class="report-section-new">
                <div class="rs-title"><span class="rs-icon">ğŸš€</span> 05. æœªæ¥3å¹´è¿›åŒ–æŒ‡å—</div>
                <div class="rs-content">
                    ä¸ºäº†è¾¾åˆ°æ›´é«˜çš„äººç”Ÿç»´åº¦ï¼Œä½ éœ€è¦ä¿®ç‚¼çš„æ˜¯<strong>â€œ${isLeader ? 'ç¤ºå¼±' : 'æ‹’ç»'}â€</strong>çš„èƒ½åŠ›ã€‚é€‚å½“${isLeader ? 'æš´éœ²è„†å¼±' : 'è®¾ç«‹è¾¹ç•Œ'}ï¼Œä¸ä¼šè®©ä½ æ˜¾å¾—${isLeader ? 'è½¯å¼±' : 'å†·æ¼ '}ï¼Œåè€Œä¼šå¢åŠ ä½ çš„äººæ ¼é­…åŠ›ã€‚
                </div>
            </div>
        `;
        document.getElementById('fullReportContent').innerHTML = html;
    }

    function scrollToPay() { document.getElementById('paySection').scrollIntoView({behavior:'smooth'}); }
    function scrollToQR() { document.querySelector('.qr-row').scrollIntoView({behavior:'smooth'}); }
    function aliPay() { window.location.href = CONFIG.ALIPAY_URL; }
    function copyWx() { navigator.clipboard.writeText("HCH91178").then(()=>{alert('å¾®ä¿¡å·å·²å¤åˆ¶ï¼\nå³å°†è·³è½¬å¾®ä¿¡...'); setTimeout(()=>{window.location.href="weixin://";},500);}).catch(()=>alert('å¤åˆ¶å¤±è´¥')); }
    function copyTxt(t) { navigator.clipboard.writeText(t).then(()=>alert('å¤åˆ¶æˆåŠŸ')).catch(()=>alert('å¤åˆ¶å¤±è´¥')); }
    
    // ================= åå°ç®¡ç†é€»è¾‘ =================
    function showAdminPanel() { 
        document.getElementById('verifyPage').classList.add('hidden');
        document.getElementById('adminPage').classList.remove('hidden');
    }
    
    function checkAdmin() {
        const pwd = document.getElementById('adminPwd').value;
        if(pwd === CONFIG.ADMIN_PWD) {
            document.getElementById('adminContent').style.display = 'block';
        } else {
            alert('âŒ å¯†ç é”™è¯¯');
        }
    }

    // ç”Ÿæˆâ€œé˜²ä¼ªâ€å¡å· + è‡ªåŠ¨å¯¼å‡º + è®°å½•æ—¥å¿—
    let logHistory = [];

    function generateAndExport() {
        const countInput = document.getElementById('genCount');
        let count = parseInt(countInput.value);
        if(isNaN(count) || count < 0) count = 0;
        if(count > 1000) { alert('ä¸€æ¬¡æœ€å¤šç”Ÿæˆ1000ä¸ª'); count = 1000; }
        
        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; 
        let newCodes = [];

        for(let i=0; i<count; i++) {
            let randomPart = '';
            for(let j=0; j<6; j++) {
                randomPart += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            const checksum = generateChecksum(randomPart);
            newCodes.push(`VIP-${randomPart}-${checksum}`);
        }
        
        // è‡ªåŠ¨ä¸‹è½½ TXT
        const textContent = newCodes.join('\n');
        const blob = new Blob([textContent], { type: "text/plain;charset=utf-8" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        const dateStr = new Date().toISOString().slice(0,10).replace(/-/g,"");
        const filename = `VIPå¡å·_${dateStr}_${count}ä¸ª.txt`;
        
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        // æ›´æ–°æ—¥å¿—
        const now = new Date();
        const timeStr = `${now.getHours()}:${now.getMinutes()<10?'0'+now.getMinutes():now.getMinutes()}`;
        const logMsg = `<span>â° ${timeStr}</span> <span>ç”Ÿæˆ <strong>${count}</strong> ä¸ª</span> <span style="color:green">å·²å¯¼å‡º âœ…</span>`;
        
        if(logHistory.length === 0) document.getElementById('logArea').innerHTML = '';
        
        logHistory.unshift(logMsg);
        
        const logHtml = logHistory.map(item => `<div class="log-item">${item}</div>`).join('');
        document.getElementById('logArea').innerHTML = logHtml;
    }
</script>
</body>
</html>
